<!DOCTYPE html>
<html lang="en">
<head>
  <title>Aqua Control</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body onload="JavaScript:AutoRefresh(5000);">
    <!--<body>-->
<script>
    //const socket = io();

    const socket = io('localhost:3000', {
			path: '/socket.io'
		});

    var control = {"sound":0,"uptime":"2018-03-14T20:21:39.806Z","outlet":[{"trigger":"Manual","triggername":"none","state":0,"name":"Outlet 1","sched":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"trigger":"Manual","triggername":"none","state":0,"name":"Outlet 2","sched":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"trigger":"Manual","triggername":"none","state":0,"name":"Outlet 3","sched":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"trigger":"Manual","triggername":"none","state":0,"name":"Outlet 4","sched":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"trigger":"Manual","triggername":"none","state":0,"name":"Outlet 5","sched":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"trigger":"Manual","triggername":"none","state":0,"name":"Outlet 6","sched":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}],"sensor":[{"name":"Success","data":0},{"name":"Sensor 2","data":0},{"name":"Sensor 3","data":0},{"name":"Sensor 4","data":0}]};
</script>

<!-- <img class="img-responsive" src="/images/background1.jpg" alt="background1.jpg"> -->

<!-- Screen Layouts -->

<!-- Warnings Screen -->
<div class="warnings_page" id="warnings_page">
        <div class="row">
            <div class="col">
                <button type="button" id="warnbutton" class="btn btn-info" onclick="go_home()">Home</button>
            </div>
        </div>
    </div>
    

<!-- Home Screen -->
<div class="screen_home" id="screen_home">
    <div class="maintmode_status" id="maintmode_status">
        off
    </div>
    
    <p id="date"></p>
    <script>
        var dt = new Date();
        document.getElementById("date").innerHTML = dt.toLocaleDateString();
        document.getElementById("date").innerHTML += " - " + dt.toLocaleTimeString();
    </script>

    <div class="row">
        <div class="col" id="tempreading">Temperature: </div>
    </div>
    <br>
    <div class="row" id="maintmode">
        <div class="col">
                    <p class="bg-danger text-white">Maintenance Mode!</p>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <button type="button" id="status_outlet1" class="btn btn-success" onclick="go_outlet_config1()">1</button>
        </div>
        <div class="col">
            <button type="button" id="status_outlet2" class="btn btn-success" onclick="go_outlet_config2()">2</button>
        </div>
        <div class="col">
            <button type="button" id="status_outlet3" class="btn btn-success">3</button>
        </div>
    </div>
    <br>
    <div class="row">
        <div class="col">
                <button type="button" id="status_outlet4" class="btn btn-success">4</button>
        </div>
        <div class="col">
                <button type="button" id="status_outlet5" class="btn btn-success">5</button>
        </div>
        <div class="col">
                <button type="button" id="status_outlet6" class="btn btn-success">6</button>
        </div>
    </div>
    <br>
    <div class="row">
        <div class="col">
            <div class="warning_box" id="warning_box">
                <p></p>
            </div>
        </div>
    </div>
    <br>
    <div class="row">
        <div class="col">
            <button type="button" class="btn btn-primary" onclick="go_sensor_list()">Sensors</button>
        </div>
        <div class="col">
            <button type="button" class="btn btn-warning" onclick="go_config_main()">Settings</button>
        </div>
    </div>
</div>


<!-- Outlet Status 1 -->
<div class="outlet_status1" id="outlet_status1">
    <p>Outlet 1</p>
    <div class="row">
        <div class="col">
            <button type="button" class="btn btn-success">On</button>
        </div>
    </div>
    <br>
    <div class="row">
        <div class="col">
            <button type="button" class="btn btn-success" onclick="go_outlet_config1()">Settings</button>
        </div>
    </div>
    <br>
    <div class="row">
        <div class="col">
            <button type="button" class="btn btn-info" onclick="go_home()">Home</button>
        </div>
    </div>
    

</div>


<!-- Main Config Screen -->
<div class="config_main" id="config_main">
    <p>Celsius or F</p>
    <p>Current time</p>
    <p>Uptime: </p>
    <div class="row">
        <div class="col">
            <button type="button" class="btn btn-success" id="sound" onclick="toggle_sound()">Sound</button>
            <button type="button" class="btn btn-success">Set Time</button>
        </div>
        <br><br>
    </div>
    <div class="logbuttons">
        <button type="button" class="btn btn-info">DL Log</button>
        <button type="button" class="btn btn-info">DL Config</button>
    </div>
    <br>
    <div class="row">
        <div class="col">
            <button type="button" class="btn btn-warning" onclick="reset_server()">RESET</button>
            <button type="button" class="btn btn-info" onclick="go_home()">Home</button>
        </div>
    </div>
    

</div>

<!-- Outlet Config 1 -->
<div class="outlet_config1" id="outlet_config1">
    <div class="outlet1_control" id="outlet1_control"></div>
    <p>Outlet Config 1</p>
    <p id="outlet_config1_name">Unknown Device</p>
    <div class="form-group">
        <label for="outletname1">Device Name:</label>
        <input type="text" class="form-control" id="outletname1">
    </div>
    <div class="dropdown">
        <button type="button" id="dbutton1" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
            Control Type
        </button>
        <div class="dropdown-menu">
            <button class="dropdown-item" type="button" onclick="select_disabled1()">Disabled</a>
            <button class="dropdown-item" type="button" onclick="select_Manual1()">Manual</a>
            <button class="dropdown-item" type="button" onclick="select_hourly1()">Hourly</a>
            <button class="dropdown-item" type="button">Sensor</a>
        </div>
    </div>
    <br>
    <div class="manual_button1" id="manual_button1">
        <button type="button" class="btn btn-danger" id="mbutton1" onclick="toggle_mbutton1()">Disabled</button>
    </div>
    <div class="manual_disabled1" id="manual_disabled1">
        <div class="alert alert-danger">
            Disabled.
        </div>
    </div>
    <div class="manual_hourly1" id="manual_hourly1">
        <div class="row">
            <div class="col">
                <div class="form-check">
                    <label class="form-check-label">
                        <input type="checkbox" class="form-check-input" value="" id="1hour0">00 to 01
                    </label>
                </div>
                <div class="form-check">
                    <label class="form-check-label">
                        <input type="checkbox" class="form-check-input" value="" id="1hour1">01 to 02
                    </label>
                </div>
                <div class="form-check">
                    <label class="form-check-label">
                        <input type="checkbox" class="form-check-input" value="" id="1hour2">02 to 03
                    </label>
                </div>
                <div class="form-check">
                    <label class="form-check-label">
                        <input type="checkbox" class="form-check-input" value="" id="1hour3">03 to 04                        
                    </label>
                </div>
                <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="1hour4">04 to 05
                        </label>
                    </div>
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="1hour5">05 to 06
                        </label>
                    </div>
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="1hour6">06 to 07
                        </label>
                    </div>
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="1hour7">07 to 08
                        </label>
                    </div>
                    <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="1hour8">08 to 09
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="1hour9">09 to 10
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="1hour10">10 to 11
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="1hour11">11 to 12                        
                            </label>
                        </div>
            </div>
            <div class="col">
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="1hour12">12 to 13
                        </label>
                    </div>
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="1hour13">13 to 14
                        </label>
                    </div>
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="1hour14">14 to 15
                        </label>
                    </div>
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="1hour15">15 to 16
                        </label>
                    </div>
                    <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="1hour16">16 to 17
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="1hour17">17 to 18
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="1hour18">18 to 19
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="1hour19">19 to 20
                            </label>
                        </div>
                        <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="1hour20">20 to 21
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="1hour21">21 to 22
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="1hour22">22 to 23
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="1hour23">23 to 00                        
                                </label>
                            </div>
                </div>
        </div>
    </div>
    <br>
    <button type="button" class="btn btn-info" onclick="submit_outlet_config1();go_home()">Home</button>
</div>

<!-- Outlet Config 2 -->
<div class="outlet_config2" id="outlet_config2">
        <div class="outlet2_control" id="outlet2_control"></div>
        <p>Outlet Config 2</p>
        <p id="outlet_config2_name">Unknown Device</p>
        <div class="form-group">
            <label for="outletname2">Device Name:</label>
            <input type="text" class="form-control" id="outletname2">
        </div>
        <div class="dropdown">
            <button type="button" id="dbutton2" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
                Control Type
            </button>
            <div class="dropdown-menu">
                <button class="dropdown-item" type="button" onclick="select_disabled2()">Disabled</a>
                <button class="dropdown-item" type="button" onclick="select_manual2()">Manual</a>
                <button class="dropdown-item" type="button" onclick="select_hourly2()">Hourly</a>
                <button class="dropdown-item" type="button">Sensor</a>
            </div>
        </div>
        <br>
        <div class="manual_button2" id="manual_button2">
            <button type="button" class="btn btn-success" id="mbutton2" onclick="toggle_mbutton2()">Disabled</button>
        </div>
        <div class="manual_disabled2" id="manual_disabled2">
            <div class="alert alert-danger">
                Disabled.
            </div>
        </div>
        <div class="manual_hourly2" id="manual_hourly2">
            <div class="row">
                <div class="col">
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="2hour0">00 to 01
                        </label>
                    </div>
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="2hour1">01 to 02
                        </label>
                    </div>
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="2hour2">02 to 03
                        </label>
                    </div>
                    <div class="form-check">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" value="" id="2hour3">03 to 04                        
                        </label>
                    </div>
                    <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="2hour4">04 to 05
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="2hour5">05 to 06
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="2hour6">06 to 07
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="2hour7">07 to 08
                            </label>
                        </div>
                        <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="2hour8">08 to 09
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="2hour9">09 to 10
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="2hour10">10 to 11
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="2hour11">11 to 12                        
                                </label>
                            </div>
                </div>
                <div class="col">
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="2hour12">12 to 13
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="2hour13">13 to 14
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="2hour14">14 to 15
                            </label>
                        </div>
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" value="" id="2hour15">15 to 16
                            </label>
                        </div>
                        <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="2hour16">16 to 17
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="2hour17">17 to 18
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="2hour18">18 to 19
                                </label>
                            </div>
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input type="checkbox" class="form-check-input" value="" id="2hour19">19 to 20
                                </label>
                            </div>
                            <div class="form-check">
                                    <label class="form-check-label">
                                        <input type="checkbox" class="form-check-input" value="" id="2hour20">20 to 21
                                    </label>
                                </div>
                                <div class="form-check">
                                    <label class="form-check-label">
                                        <input type="checkbox" class="form-check-input" value="" id="2hour21">21 to 22
                                    </label>
                                </div>
                                <div class="form-check">
                                    <label class="form-check-label">
                                        <input type="checkbox" class="form-check-input" value="" id="2hour22">22 to 23
                                    </label>
                                </div>
                                <div class="form-check">
                                    <label class="form-check-label">
                                        <input type="checkbox" class="form-check-input" value="" id="2hour23">23 to 00                        
                                    </label>
                                </div>
                    </div>
            </div>
        </div>
        <br>
        <button type="button" class="btn btn-info" onclick="submit_outlet_config2();go_home()">Home</button>
    </div>

<!-- Sensor List -->
<div class="sensor_list" id="sensor_list">
    <div class="btn-group-vertical">
        <button type="button" class="btn btn-primary" id="sensor1" onclick="go_config_sensor1()">1</button>
        <button type="button" class="btn btn-primary" id="sensor2">2</button>
        <button type="button" class="btn btn-primary" id="sensor3">3</button>
        <button type="button" class="btn btn-primary" id="sensor4">4</button>
    </div>
    <br><br>
    <div class="row">
        <div class="col">
            <button type="button" class="btn btn-info" onclick="go_home()">Home</button>
        </div>
    </div>
</div>

<!-- Config Sensor 1 -->
<div class="config_sensor1" id="config_sensor1">
    <div class="form-group">
        <label for="sensorname1">Sensor Name:</label>
        <input type="text" class="form-control" id="sensorname1">
    </div>
    <div class="sensor_status1" id="sensor_status1">
            <button type="button" class="btn btn-danger" id="sbutton1" onclick="toggle_sbutton1()">Disabled</button>
        </div>
    <div class="form-group">
            <label for="sensorname1">Data Type:</label>
            <input type="text" class="form-control" id="datatype1"> 
        </div>
    <div class="form-group">
        <label for="lowtrigger1">Low Trigger:</label>
        <input type="text" class="form-control" id="lowtrigger1">
    </div>
    <div class="form-group">
        <label for="hightrigger1">High Trigger:</label>
        <input type="text" class="form-control" id="hightrigger1">        
    </div>
    <button type="button" class="btn btn-info" onclick="submit_sensor_config1();go_home()">Home</button>
</div>

<!-- Control Functions -->
<script>
        function reset_server()
        {
            socket.emit('reset', control);
        }
        function submit_sensor_config1()
        {
            control.sensor[0].name = document.getElementById("sensorname1").value;
            control.sensor[0].lowtrigger = document.getElementById("lowtrigger1").value;
            control.sensor[0].hightrigger = document.getElementById("hightrigger1").value;
            control.sensor[0].datatype = document.getElementById("datatype1").value;
            
            socket.emit('control update', control);
        }
        function submit_outlet_config1()
        {
            control.outlet[0].sched[0] = document.getElementById("1hour0").checked;
            control.outlet[0].sched[1] = document.getElementById("1hour1").checked;
            control.outlet[0].sched[2] = document.getElementById("1hour2").checked;
            control.outlet[0].sched[3] = document.getElementById("1hour3").checked;
            control.outlet[0].sched[4] = document.getElementById("1hour4").checked;
            control.outlet[0].sched[5] = document.getElementById("1hour5").checked;
            control.outlet[0].sched[6] = document.getElementById("1hour6").checked;
            control.outlet[0].sched[7] = document.getElementById("1hour7").checked;
            control.outlet[0].sched[8] = document.getElementById("1hour8").checked;
            control.outlet[0].sched[9] = document.getElementById("1hour9").checked;
            control.outlet[0].sched[10] = document.getElementById("1hour10").checked;
            control.outlet[0].sched[11] = document.getElementById("1hour11").checked;
            control.outlet[0].sched[12] = document.getElementById("1hour12").checked;
            control.outlet[0].sched[13] = document.getElementById("1hour13").checked;
            control.outlet[0].sched[14] = document.getElementById("1hour14").checked;
            control.outlet[0].sched[15] = document.getElementById("1hour15").checked;
            control.outlet[0].sched[16] = document.getElementById("1hour16").checked;
            control.outlet[0].sched[17] = document.getElementById("1hour17").checked;
            control.outlet[0].sched[18] = document.getElementById("1hour18").checked;
            control.outlet[0].sched[19] = document.getElementById("1hour19").checked;
            control.outlet[0].sched[20] = document.getElementById("1hour20").checked;
            control.outlet[0].sched[21] = document.getElementById("1hour21").checked;
            control.outlet[0].sched[22] = document.getElementById("1hour22").checked;
            control.outlet[0].sched[23] = document.getElementById("1hour23").checked;
            control.outlet[0].name = document.getElementById("outletname1").value;
            socket.emit('control update', control);

        }

        function submit_outlet_config2()
        {
            control.outlet[1].sched[0] = document.getElementById("2hour0").checked;
            control.outlet[1].sched[1] = document.getElementById("2hour1").checked;
            control.outlet[1].sched[2] = document.getElementById("2hour2").checked;
            control.outlet[1].sched[3] = document.getElementById("2hour3").checked;
            control.outlet[1].sched[4] = document.getElementById("2hour4").checked;
            control.outlet[1].sched[5] = document.getElementById("2hour5").checked;
            control.outlet[1].sched[6] = document.getElementById("2hour6").checked;
            control.outlet[1].sched[7] = document.getElementById("2hour7").checked;
            control.outlet[1].sched[8] = document.getElementById("2hour8").checked;
            control.outlet[1].sched[9] = document.getElementById("2hour9").checked;
            control.outlet[1].sched[10] = document.getElementById("2hour10").checked;
            control.outlet[1].sched[11] = document.getElementById("2hour11").checked;
            control.outlet[1].sched[12] = document.getElementById("2hour12").checked;
            control.outlet[1].sched[13] = document.getElementById("2hour13").checked;
            control.outlet[1].sched[14] = document.getElementById("2hour14").checked;
            control.outlet[1].sched[15] = document.getElementById("2hour15").checked;
            control.outlet[1].sched[16] = document.getElementById("2hour16").checked;
            control.outlet[1].sched[17] = document.getElementById("2hour17").checked;
            control.outlet[1].sched[18] = document.getElementById("2hour18").checked;
            control.outlet[1].sched[19] = document.getElementById("2hour19").checked;
            control.outlet[1].sched[20] = document.getElementById("2hour20").checked;
            control.outlet[1].sched[21] = document.getElementById("2hour21").checked;
            control.outlet[1].sched[22] = document.getElementById("2hour22").checked;
            control.outlet[1].sched[23] = document.getElementById("2hour23").checked;
            control.outlet[1].name = document.getElementById("outletname2").value;
            socket.emit('control update', control);

        }

        function go_home()
        {
            if (document.getElementById("config_sensor1").style.display === 'block')
                setup_sensornames();

            document.getElementById("outlet_status1").style.display = 'none';
            //document.getElementById("outlet_status2").style.display = 'none';
            //document.getElementById("outlet_status3").style.display = 'none';
            //document.getElementById("outlet_status4").style.display = 'none';
            //document.getElementById("outlet_status5").style.display = 'none';
            //document.getElementById("outlet_status6").style.display = 'none';
    
            document.getElementById("warnings_page").style.display = 'none';
            document.getElementById("config_main").style.display = 'none';
    
            document.getElementById("outlet_config1").style.display = 'none';
            document.getElementById("outlet_config2").style.display = 'none';
            //document.getElementById("outlet_config3").style.display = 'none';
            //document.getElementById("outlet_config4").style.display = 'none';
            //document.getElementById("outlet_config5").style.display = 'none';
            //document.getElementById("outlet_config6").style.display = 'none';
    
            document.getElementById("sensor_list").style.display = 'none';
    
            document.getElementById("config_sensor1").style.display = 'none';
            //document.getElementById("config_sensor2").style.display = 'none';
            //document.getElementById("config_sensor3").style.display = 'none';
            //document.getElementById("config_sensor4").style.display = 'none';
            //document.getElementById("config_sensor5").style.display = 'none';
            //document.getElementById("config_sensor6").style.display = 'none';
            refresh_warns();
            document.getElementById("screen_home").style.display = 'block';

            


        }
    
        function refresh_warns()
        {
            var numwarns = document.getElementsByClassName("alert alert-danger alert-dismissable fade show").length;
            var html = '<button type="button" class="btn btn-'
            if (numwarns > 0)
                html += 'danger';
            else
                html += 'success';
            html += '" onclick="go_warnings_page()">Warnings:   ';
            html += '<span class="badge badge-light">' + numwarns + '</span></button>';
            document.getElementById("warning_box").innerHTML = html;            
            
        }
    
        function go_sensor_list()
        {
            document.getElementById("sensorname1").innerHTML = control.sensor[0].name;
            document.getElementById("sensor1").innerHTML = control.sensor[0].name;
            document.getElementById("sensor1").innerHTML = control.sensor[0].name + " : " + control.sensor[0].data;
            //document.getElementById("sensorname1").innerHTML = control.sensor[0].name + " : " + control.sensor[0].data;
            //document.getElementById("sensor2").innerHTML = control.sensor[1].name;
            //document.getElementById("sensor3").innerHTML = control.sensor[2].name;
            //document.getElementById("sensor4").innerHTML = control.sensor[3].name;
            document.getElementById("screen_home").style.display = 'none';
            document.getElementById("sensor_list").style.display = 'block';
        }
    
    
        function go_outlet_config1()
        {
            go_home();
            document.getElementById("screen_home").style.display = 'none';
            document.getElementById("outlet_config1").style.display='block';
            document.getElementById("manual_hourly1").style.display = 'none';
            document.getElementById("manual_disabled1").style.display = 'none';
            document.getElementById("manual_button1").style.display = 'none';
            if (control.outlet[0].trigger == "Disabled")
                document.getElementById("manual_disabled1").style.display = 'block';
            if (control.outlet[0].trigger == "Manual")
                document.getElementById("manual_button1").style.display = 'block';
            if (control.outlet[0].trigger == "Hourly")
                document.getElementById("manual_hourly1").style.display = 'block';

            if (control.outlet[0].state == 0)
            {
                $("#mbutton1").removeClass("btn btn-success").addClass("btn btn-danger");
            }
            else
            {
                $("#mbutton1").removeClass("btn btn-danger").addClass("btn btn-success");
            }
            
            document.getElementById("outlet_config1_name").innerHTML = control.outlet[0].name;

            document.getElementById("1hour0").checked = control.outlet[0].sched[0];
            document.getElementById("1hour1").checked = control.outlet[0].sched[1];
            document.getElementById("1hour2").checked = control.outlet[0].sched[2];
            document.getElementById("1hour3").checked = control.outlet[0].sched[3];
            document.getElementById("1hour4").checked = control.outlet[0].sched[4];
            document.getElementById("1hour5").checked = control.outlet[0].sched[5];
            document.getElementById("1hour6").checked = control.outlet[0].sched[6];
            document.getElementById("1hour7").checked = control.outlet[0].sched[7];
            document.getElementById("1hour8").checked = control.outlet[0].sched[8];
            document.getElementById("1hour9").checked = control.outlet[0].sched[9];
            document.getElementById("1hour10").checked = control.outlet[0].sched[10];
            document.getElementById("1hour11").checked = control.outlet[0].sched[11];
            document.getElementById("1hour12").checked = control.outlet[0].sched[12];
            document.getElementById("1hour13").checked = control.outlet[0].sched[13];
            document.getElementById("1hour14").checked = control.outlet[0].sched[14];
            document.getElementById("1hour15").checked = control.outlet[0].sched[15];
            document.getElementById("1hour16").checked = control.outlet[0].sched[16];
            document.getElementById("1hour17").checked = control.outlet[0].sched[17];
            document.getElementById("1hour18").checked = control.outlet[0].sched[18];
            document.getElementById("1hour19").checked = control.outlet[0].sched[19];
            document.getElementById("1hour20").checked = control.outlet[0].sched[20];
            document.getElementById("1hour21").checked = control.outlet[0].sched[21];
            document.getElementById("1hour22").checked = control.outlet[0].sched[22];
            document.getElementById("1hour23").checked = control.outlet[0].sched[23];
        }

        function go_outlet_config2()
        {
            go_home();
            document.getElementById("screen_home").style.display = 'none';
            document.getElementById("outlet_config2").style.display='block';
            document.getElementById("manual_hourly2").style.display = 'none';
            document.getElementById("manual_disabled2").style.display = 'none';
            document.getElementById("manual_button2").style.display = 'none';
            if (control.outlet[1].trigger == "Disabled")
                document.getElementById("manual_disabled2").style.display = 'block';
            if (control.outlet[1].trigger == "Manual")
                document.getElementById("manual_button2").style.display = 'block';
            if (control.outlet[1].trigger == "Hourly")
                document.getElementById("manual_hourly2").style.display = 'block';

            if (control.outlet[1].state == 0)
            {
                $("#mbutton2").removeClass("btn btn-success").addClass("btn btn-danger");
            }
            else
            {
                $("#mbutton2").removeClass("btn btn-danger").addClass("btn btn-success");
            }

            document.getElementById("outlet_config2_name").innerHTML = control.outlet[1].name;


            document.getElementById("2hour0").checked = control.outlet[1].sched[0];
            document.getElementById("2hour1").checked = control.outlet[1].sched[1];
            document.getElementById("2hour2").checked = control.outlet[1].sched[2];
            document.getElementById("2hour3").checked = control.outlet[1].sched[3];
            document.getElementById("2hour4").checked = control.outlet[1].sched[4];
            document.getElementById("2hour5").checked = control.outlet[1].sched[5];
            document.getElementById("2hour6").checked = control.outlet[1].sched[6];
            document.getElementById("2hour7").checked = control.outlet[1].sched[7];
            document.getElementById("2hour8").checked = control.outlet[1].sched[8];
            document.getElementById("2hour9").checked = control.outlet[1].sched[9];
            document.getElementById("2hour10").checked = control.outlet[1].sched[10];
            document.getElementById("2hour11").checked = control.outlet[1].sched[11];
            document.getElementById("2hour12").checked = control.outlet[1].sched[12];
            document.getElementById("2hour13").checked = control.outlet[1].sched[13];
            document.getElementById("2hour14").checked = control.outlet[1].sched[14];
            document.getElementById("2hour15").checked = control.outlet[1].sched[15];
            document.getElementById("2hour16").checked = control.outlet[1].sched[16];
            document.getElementById("2hour17").checked = control.outlet[1].sched[17];
            document.getElementById("2hour18").checked = control.outlet[1].sched[18];
            document.getElementById("2hour19").checked = control.outlet[1].sched[19];
            document.getElementById("2hour20").checked = control.outlet[1].sched[20];
            document.getElementById("2hour21").checked = control.outlet[1].sched[21];
            document.getElementById("2hour22").checked = control.outlet[1].sched[22];
            document.getElementById("2hour23").checked = control.outlet[1].sched[23];
        }
    
        function go_config_main()
        {
            go_home();
            document.getElementById("screen_home").style.display = 'none';
            document.getElementById("config_main").style.display='block';
        }
    
        function go_config_sensor1()
        {
            go_home();
            document.getElementById("sensorname1").value = control.sensor[0].name;
            document.getElementById("lowtrigger1").value = control.sensor[0].lowtrigger;
            document.getElementById("hightrigger1").value = control.sensor[0].hightrigger;
            document.getElementById("datatype1").value = control.sensor[0].datatype;
            document.getElementById("screen_home").style.display = 'none';
            document.getElementById("config_sensor1").style.display='block';
        }
    
        function go_warnings_page()
        {
            go_home();
            document.getElementById("screen_home").style.display = 'none';
            document.getElementById("warnings_page").style.display='block';
        }

        function select_hourly1()
        {
            //document.getElementById("screen_home").style.display = 'none';
            document.getElementById("manual_hourly1").style.display = 'block';
            document.getElementById("manual_disabled1").style.display = 'none';
            document.getElementById("manual_button1").style.display = 'none';
            //document.getElementById("outlet1_control").textContent = "hourly";
            control.outlet[0].trigger = "Hourly";
            control.outlet[0].state = 0;
            control.outlet[0].name = document.getElementById("outletname1").value;
            socket.emit('control update', control);
        }

        function select_hourly2()
        {
            //document.getElementById("screen_home").style.display = 'none';
            document.getElementById("manual_hourly2").style.display = 'block';
            document.getElementById("manual_disabled2").style.display = 'none';
            document.getElementById("manual_button2").style.display = 'none';
            //document.getElementById("outlet2_control").textContent = "hourly";
            control.outlet[1].trigger = "Hourly";
            control.outlet[1].state = 0;
            control.outlet[1].name = document.getElementById("outletname2").value;
            socket.emit('control update', control);
        }

        function select_manual1()
        {
            //document.getElementById("screen_home").style.display = 'none';
            document.getElementById("manual_hourly1").style.display = 'none';
            document.getElementById("manual_disabled1").style.display = 'none';
            document.getElementById("manual_button1").style.display = 'block';
            control.outlet[0].trigger = "Manual";
            control.outlet[0].state = 0;
            control.outlet[0].name = document.getElementById("outletname1").value;
            socket.emit('control update', control);
            
        }

        function select_manual2()
        {
            //document.getElementById("screen_home").style.display = 'none';
            document.getElementById("manual_hourly2").style.display = 'none';
            document.getElementById("manual_disabled2").style.display = 'none';
            document.getElementById("manual_button2").style.display = 'block';
            control.outlet[1].trigger = "Manual";
            control.outlet[1].state = 0;
            control.outlet[1].name = document.getElementById("outletname2").value;
            socket.emit('control update', control);
            
        }

        function toggle_sbutton1()
        {
            var btnclassName = $('#sbutton1').attr('class');
            if (btnclassName === "btn btn-success")
            {
                $("#sbutton1").removeClass("btn btn-success").addClass("btn btn-danger");
                document.getElementById("sbutton1").innerHTML = "Disabled";
                control.sensor[0].status = "Disabled";
                //control.outlet[0].name = document.getElementById("outletname1").value;
                socket.emit('control update', control);

            }
            else
            {
                $("#sbutton1").removeClass("btn btn-danger").addClass("btn btn-success");
                control.sensor[0].status = "Enabled";
                document.getElementById("sbutton1").innerHTML = "Enabled";
                //control.outlet[0].name = document.getElementById("outletname1").value;
                socket.emit('control update', control);
            }
        }

        function toggle_mbutton1()
        {
            var btnclassName = $('#mbutton1').attr('class');
            if (btnclassName === "btn btn-success")
            {
                $("#mbutton1").removeClass("btn btn-success").addClass("btn btn-danger");
                document.getElementById("mbutton1").innerHTML = "Disabled";
                control.outlet[0].state = 0;
                control.outlet[0].name = document.getElementById("outletname1").value;
                socket.emit('control update', control);

            }
            else
            {
                $("#mbutton1").removeClass("btn btn-danger").addClass("btn btn-success");
                document.getElementById("mbutton1").innerHTML = "Enabled";
                control.outlet[0].state = 1;
                control.outlet[0].name = document.getElementById("outletname1").value;
                socket.emit('control update', control);
            }
        }

        function toggle_mbutton2()
        {
            var btnclassName = $('#mbutton2').attr('class');
            if (btnclassName === "btn btn-success")
            {
                $("#mbutton2").removeClass("btn btn-success").addClass("btn btn-danger");
                document.getElementById("mbutton2").innerHTML = "Disabled";
                control.outlet[1].state = 0;
                control.outlet[1].name = document.getElementById("outletname2").value;
                socket.emit('control update', control);

            }
            else
            {
                $("#mbutton2").removeClass("btn btn-danger").addClass("btn btn-success");
                document.getElementById("mbutton2").innerHTML = "Enabled";
                control.outlet[1].state = 1;
                control.outlet[1].name = document.getElementById("outletname2").value;
                socket.emit('control update', control);
            }
        }

        function select_disabled1()
        {
            //document.getElementById("screen_home").style.display = 'none';
            document.getElementById("manual_hourly1").style.display = 'none';
            document.getElementById("manual_disabled1").style.display = 'block';
            document.getElementById("manual_button1").style.display = 'none';
            //document.getElementById("outlet1_control").textContent = "Disabled";
            //send disabled to Arduino
            control.outlet[0].trigger = "Disabled";
            control.outlet[0].state = 0;
            control.outlet[0].name = document.getElementById("outletname1").value;
            socket.emit('control update', control);
        }

        function select_disabled2()
        {
            //document.getElementById("screen_home").style.display = 'none';
            document.getElementById("manual_hourly2").style.display = 'none';
            document.getElementById("manual_disabled2").style.display = 'block';
            document.getElementById("manual_button2").style.display = 'none';
            //document.getElementById("outlet2_control").textContent = "Disabled";
            //send disabled to Arduino
            control.outlet[1].trigger = "Disabled";
            control.outlet[1].state = 0;
            control.outlet[1].name = document.getElementById("outletname2").value;
            socket.emit('control update', control);
        }

        function toggle_sound()
        {
            var btnclassName = $('#sound').attr('class');
            if (btnclassName === "btn btn-success")
            {
                $("#sound").removeClass("btn btn-success").addClass("btn btn-danger");
                control.sound = 0;
                socket.emit('control update', control);

            }
            else
            {
                $("#sound").removeClass("btn btn-danger").addClass("btn btn-success");
                control.sound = 1;
                socket.emit('control update', control);
            }
        }

        function setup_outlets()
        {
            /*
            if (document.getElementById("outlet1_control").textContent === "Disabled")
            //if (control.outlet[0].trigger = "Disabled")
            {
                select_disabled1();                
            }
            
            if (document.getElementById("outlet1_control").textContent === "manualoff")
            {
                select_manual1();
            }
            
            if (document.getElementById("outlet1_control").textContent === "manualon")
            {
                select_manual1();
            }
            */
            
        }

        function setup_maintmode()
        {
            if (document.getElementById("maintmode_status").textContent === "on")
                document.getElementById("maintmode").style.display = 'block';
            else
                document.getElementById("maintmode").style.display = 'none';
        }

        function set_maintmode(toggle)
        {
            document.getElementById("maintmode_status").textContent = toggle;
        }

        function setup_sensornames()
        {
            if (document.getElementById("sensorname1").value !== "")
            {
                document.getElementById("sensor1").textContent = document.getElementById("sensorname1").value;
            }
            /*fuck
            if (document.getElementById("sensorname2").value !== null)
            {
                document.getElementById("sensor2").textContent = document.getElementById("sensorname2").value;
            }
            if (document.getElementById("sensorname3").value !== null)
            {
                document.getElementById("sensor3").textContent = document.getElementById("sensorname3").value;
            }
            if (document.getElementById("sensorname4").value !== null)
            {
                document.getElementById("sensor4").textContent = document.getElementById("sensorname4").value;
            }
            */
        }

        refresh_warns();

        setup_outlets();

        setup_maintmode();

        setup_sensornames();
    
        //alert("Setup complete.");

    </script>


<!-- Style Display Hiders -->

<style>
    .screen_home {
	display: block;
    }
    .outlet_status1 {
	display: none;
    }
    .warnings_page {
	display: none;
    }
    .config_main {
	display: none;
    }
    .outlet_config1 {
	display: none;
    }
    .outlet_config2 {
	display: none;
    }
    .sensor_list {
	display: none;
    }
    .config_sensor1 {
	display: none;
    }
    #warnings_set {
    display: none;
    }
    .manual_button1 {
    display: none;
    }
    .manual_disabled1 {
    display: none;
    }
    .manual_hourly1 {
    display: none;
    }
    .mbutton1 {
    display: block;
    }
    .outlet1_control {
    display: none;
    }
    .maintmode_status {
    display: none;
    }
</style>

<!--
<style>
.screen_home {
    float: left;
    margin: 0 20px 20px 0;
    border: 1px solid blue;
    padding: 0 5px 0 5px;
    width: 240px;
}
</style>
-->

<!-- Style Definitions -->



<style>
body {
    background-image: url("images/background1.jpg");
    background-color: #cccccc;
    background-blend-mode: darken;
    background-size: cover;
}
.screen_home {
    margin: auto;
    margin-top: 100px;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    width: 240px;
    background-color: #cccccc;
}
.outlet_status1 {
    margin: auto;
    margin-top: 100px;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    width: 240px;
    background-color: #cccccc;
}
.sensor_list {
    margin: auto;
    margin-top: 100px;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    width: 240px;
    background-color: #cccccc;
}
.outlet_config1 {
    margin: auto;
    margin-top: 100px;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    width: 240px;
    background-color: #cccccc;
}
.outlet_config2 {
    margin: auto;
    margin-top: 100px;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    width: 240px;
    background-color: #cccccc;
}
.warnings_page {
    margin: auto;
    margin-top: 100px;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    width: 240px;
    background-color: #cccccc;
}
.config_main {
    margin: auto;
    margin-top: 100px;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    width: 240px;
    background-color: #cccccc;
}
.config_sensor1 {
    margin: auto;
    margin-top: 100px;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    width: 240px;
    background-color: #cccccc;
}
</style>


<!--
<style>
.screen_home {
    margin: 0 20px 20px 0;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    
}
.outlet_status1 {
    margin: 0 20px 20px 0;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    
}
.sensor_list {
    margin: 0 20px 20px 0;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    
}
.outlet_config1 {
    margin: 0 20px 20px 0;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    
}
.warnings_page {
    margin: 0 20px 20px 0;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    
}
.config_main {
    margin: 0 20px 20px 0;
    border: 1px solid blue;
    padding: 5px 5px 5px 5px;
    
}
</style>
-->


<script>
    
    

    socket.on('setup', function(msg)
    {
        control = msg;
    });

    socket.on('control update', function(msg)
    {
        control = msg;
        //console.log(msg);

        if (control.outlet[0].state == 0)
        {
            $("#status_outlet1").removeClass("btn btn-success").addClass("btn btn-danger");
        }
        else
        {
            $("#status_outlet1").removeClass("btn btn-danger").addClass("btn btn-success");
        }

        if (control.outlet[1].state == 0)
        {
            $("#status_outlet2").removeClass("btn btn-success").addClass("btn btn-danger");
        }
        else
        {
            $("#status_outlet2").removeClass("btn btn-danger").addClass("btn btn-success");
        }

        if (control.outlet[2].state == 0)
        {
            $("#status_outlet3").removeClass("btn btn-success").addClass("btn btn-danger");
        }
        else
        {
            $("#status_outlet3").removeClass("btn btn-danger").addClass("btn btn-success");
        }

        if (control.outlet[3].state == 0)
        {
            $("#status_outlet4").removeClass("btn btn-success").addClass("btn btn-danger");
        }
        else
        {
            $("#status_outlet4").removeClass("btn btn-danger").addClass("btn btn-success");
        }

        if (control.outlet[4].state == 0)
        {
            $("#status_outlet5").removeClass("btn btn-success").addClass("btn btn-danger");
        }
        else
        {
            $("#status_outlet5").removeClass("btn btn-danger").addClass("btn btn-success");
        }

        if (control.outlet[5].state == 0)
        {
            $("#status_outlet6").removeClass("btn btn-success").addClass("btn btn-danger");
        }
        else
        {
            $("#status_outlet6").removeClass("btn btn-danger").addClass("btn btn-success");
        }
        document.getElementById("sensor1").innerHTML = control.sensor[0].name + " : " + control.sensor[0].data;
        document.getElementById("sensor2").innerHTML = control.sensor[1].name + " : " + control.sensor[1].data;
        document.getElementById("sensor3").innerHTML = control.sensor[2].name + " : " + control.sensor[2].data;
        document.getElementById("sensor4").innerHTML = control.sensor[3].name + " : " + control.sensor[3].data;
        document.getElementById("tempreading").innerHTML = "Temperature: " + control.sensor[0].data + "°F";

        console.log('dbutton1 innerhtml: ' + document.getElementById("dbutton1").innerHTML);
        document.getElementById("dbutton1").innerHTML = control.outlet[0].trigger;
        console.log('dbutton1: ' + control.outlet[0].trigger);
        document.getElementById("dbutton2").innerHTML = control.outlet[1].trigger;

        for (var i = 0, len = control.warning.length; i < len; i++) 
        {
            var check = document.getElementById('warn' + control.warning[i].type);
            
            //figure out a way to add a counter to it
            //if (check != null)
                

            if ((control.warning[i].type != 0) && (check == null))
            {
                //fuck
                //<button type="button" class="close" data-dismiss="alert">&times;</button>
                console.log('Warning rxd from server.');
                console.log('Warning: ' + control.warning[i].text);
                var output = document.getElementById("warnings_page");
                var ele = document.createElement("div");
                ele.setAttribute("class","alert alert-danger alert-dismissable fade show");
                ele.setAttribute('id', 'warn' + control.warning[i].type);
                var butt = document.createElement('a');
                butt.setAttribute('href', '#');
                butt.setAttribute('class', 'close');
                //butt.setAttribute("button type", "button");
                butt.setAttribute('data-dismiss', 'alert');
                butt.setAttribute('aria-label','close');
                butt.innerHTML = '&times;';
                    
                ele.innerHTML = control.warning[i].text;
                ele.appendChild(butt);
                
                //output.appendChild(ele);
                var parentDiv = document.getElementById("warnbutton").parentNode;
                var warn = document.getElementById("warnbutton");
                parentDiv.insertBefore(ele, warn);

                //console.log(msg);
            }
        }

        refresh_warns();
        
    });

    socket.on('sensor update', function(msg)
    {
        document.getElementById("sensor1").innerHTML = control.sensor[0].name + " : " + control.sensor[0].data;
        //document.getElementById("sensorname1").innerHTML = control.sensor[0].name + ": " + control.sensor[0].data;
        document.getElementById("sensor2").innerHTML = control.sensor[1].name + " : " + control.sensor[1].data;
        document.getElementById("sensor3").innerHTML = control.sensor[2].name + " : " + control.sensor[2].data;
        document.getElementById("sensor4").innerHTML = control.sensor[3].name + " : " + control.sensor[3].data;
        document.getElementById("tempreading").innerHTML = "Temperature: " + control.sensor[0].data + "°F";
        //console.log(msg);
    });

    socket.on('warning', function(msg)
    {
        control = msg;
            
        refresh_warns();
        //location.reload(true);

    });


</script>

<script type="text/JavaScript">
    //<!--
        function update()
        {
            socket.emit('update', 'fetch update requested from web');
        }

       function AutoRefresh( t ) 
       {
          setInterval(update, t);
       }
    //-->
 </script>

</body>
</html>
